<!DOCTYPE html>
<html lang="en">
  <%- include('./partials/head.ejs') %>
  <body>
    <!-- if use "=" it escapes special characters and we end up a string value instead of raw html -->
    <%- include('./partials/nav.ejs') %>
    <div class="id-content">
      <h2 class="text-success text-uppercase"><%= books.title %></h2>
      <p class="id-content-head">ID</p>
      <p><%= books.id %></p>
      <p class="id-content-head">Author</p>
      <p><%= books.author %></p>
      <p class="id-content-head">Order Status</p>
      <p><%= books.order %></p>
      <p class="id-content-head">Completed?</p>
      <p><%= books.completed %></p>
      <p class="id-content-head">Created at:</p>
      <p><%= books.createdAt %></p>
      <p class="id-content-head">Updated at:</p>
      <p><%= books.updatedAt %></p>
      <div>
        <a href="/update/<%= books._id %>"
          ><i class="fa-solid fa-pen-to-square"></i
        ></a>
        <a class="delete" data-doc="<%= books._id %>"
          ><i class="fa-solid fa-trash"></i
        ></a>
      </div>
    </div>
    <%- include('./partials/footer.ejs') %>

    <script>
      const deleteItem = document.querySelector("a.delete");

      deleteItem.addEventListener("click", function (e) {
        const endpoint = `/books/${deleteItem.dataset.doc}`;

        fetch(endpoint, {
          method: "DELETE",
        })
          .then((response) => response.json())
          .then((data) => (window.location.href = data.redirect))
          .catch((err) => console.log(err));
      });
    </script>
  </body>
</html>
